const API_URL = "https://script.google.com/macros/s/AKfycbwirhArJRzhoAZdoK7K3nuQrai6-N8zGd8BiPNrg-SgGas00szkkdmhCSrnaKVlPIq2/exec"; // 換成你部署的網址

async function loadTodos() {
  const res = await fetch(API_URL);
  todos = await res.json();

  const list = document.getElementById("todoList");
  list.innerHTML = "";

  todos.forEach((t, index) => {
    const li = document.createElement("li");
    li.textContent = `${t.date} ${t.time} ➝ ${t.name}`;

    const delBtn = document.createElement("button");
    delBtn.textContent = "刪除";
    delBtn.onclick = async () => {
      await fetch(`${API_URL}?name=${encodeURIComponent(t.name)}`, { method: "DELETE" });
      loadTodos();
    };

    li.appendChild(delBtn);
    list.appendChild(li);
  });
}

async function addTodo() {
  const name = document.getElementById("todoName").value.trim();
  const date = document.getElementById("todoDate").value;
  const time = document.getElementById("todoTime").value;

  if (!name || !date || !time) {
    alert("請輸入名稱、日期和時間！");
    return;
  }

  await fetch(API_URL, {
    method: "POST",
    body: JSON.stringify({ name, date, time }),
    headers: { "Content-Type": "application/json" }
  });

  loadTodos();

  document.getElementById("todoName").value = "";
  document.getElementById("todoDate").value = "";
  document.getElementById("todoTime").value = "";
}
